<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√∫brica Interactiva con Diagn√≥stico</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #2980b9;
            --bg-weak: #ffebee;     /* Rojo suave */
            --bg-dev: #fff3e0;      /* Naranja suave */
            --bg-solid: #e8f5e9;    /* Verde suave */
            --text-weak: #c62828;
            --text-dev: #ef6c00;
            --text-solid: #2e7d32;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 950px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
            background-color: #f4f6f8;
        }

        .container {
            background: white;
            padding: 40px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border-radius: 8px;
        }

        /* Header */
        header { border-bottom: 2px solid var(--primary); margin-bottom: 30px; padding-bottom: 20px; }
        h1 { color: var(--primary); margin-top: 0; }
        
        .header-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .input-group label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.9em; color: #555; }
        .input-group input { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }

        /* Table */
        table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
        th { background-color: var(--primary); color: white; padding: 12px; text-align: left; }
        .th-scale { text-align: center; width: 110px; font-size: 0.9em; }
        td { padding: 12px; border-bottom: 1px solid #eee; vertical-align: middle; }
        
        tr.category-header td {
            background-color: #eceff1;
            font-weight: bold;
            color: var(--primary);
            padding-top: 15px;
            border-bottom: 2px solid #cfd8dc;
            font-size: 1.05em;
        }

        /* Interactive Cells */
        .score-cell {
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.2em;
            user-select: none;
        }
        .score-cell:hover { background-color: #f0f0f0; transform: scale(1.05); }

        .selected-1 { background-color: var(--bg-weak); color: var(--text-weak); box-shadow: inset 0 0 0 2px var(--text-weak); }
        .selected-2 { background-color: var(--bg-dev); color: var(--text-dev); box-shadow: inset 0 0 0 2px var(--text-dev); }
        .selected-3 { background-color: var(--bg-solid); color: var(--text-solid); box-shadow: inset 0 0 0 2px var(--text-solid); }

        /* RESULT DASHBOARD STYLES */
        .dashboard {
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-top: 40px;
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
        }

        .score-box {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 8px;
            border-top: 5px solid var(--accent);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .big-score { font-size: 2.5em; font-weight: bold; color: var(--primary); display: block; }
        .score-label { font-size: 0.9em; color: #666; text-transform: uppercase; letter-spacing: 1px; }

        .analysis-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border-top: 5px solid var(--text-weak);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .analysis-box h3 { margin-top: 0; color: var(--text-weak); display: flex; align-items: center; gap: 10px; }
        
        .weakness-list { padding-left: 20px; margin: 0; }
        .weakness-list li { margin-bottom: 8px; line-height: 1.4; }
        .tag-cat { font-weight: bold; color: #555; font-size: 0.85em; display: block; margin-bottom: 2px;}
        .tag-crit { color: #333; }
        .badge-1 { background: var(--text-weak); color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.7em; vertical-align: middle; }
        .badge-2 { background: var(--text-dev); color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.7em; vertical-align: middle; }

        /* Comments & Print */
        .comments-section { margin-top: 20px; }
        textarea { width: 100%; height: 80px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-family: inherit; }
        .actions { margin-top: 20px; text-align: right; }
        button { padding: 12px 25px; background-color: var(--primary); color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1em; font-weight: bold;}
        button:hover { background-color: #34495e; }

        @media print {
            body { background: white; padding: 0; }
            .container { box-shadow: none; padding: 0; border: none; }
            .actions { display: none; }
            .dashboard { border: 1px solid #000; break-inside: avoid; }
            .score-box, .analysis-box { box-shadow: none; border: 1px solid #ccc; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>R√∫brica de Observaci√≥n e Inteligencia Pedag√≥gica</h1>
        <div class="header-inputs">
            <div class="input-group"><label>Planificaci√≥n (√Årea):</label><input type="text"></div>
            <div class="input-group"><label>Ciclo Lectivo:</label><input type="text"></div>
            <div class="input-group"><label>Curso:</label><input type="text"></div>
        </div>
    </header>

    <div id="rubric-table">
        </div>

    <div class="dashboard">
        <div class="score-box">
            <span class="score-label">Puntaje Global</span>
            <span class="big-score" id="total-score">0 / 0</span>
            <div id="percentage-display" style="color: #7f8c8d; margin-top: 5px;">0%</div>
        </div>

        <div class="analysis-box">
            <h3>‚ö†Ô∏è Foco de Mejora</h3>
            <p id="empty-state" style="color:#777; font-style:italic; font-size: 0.9em;">
                Seleccione los criterios en la tabla. Aqu√≠ aparecer√°n autom√°ticamente los puntos d√©biles (nivel 1) y en desarrollo (nivel 2).
            </p>
            <ul class="weakness-list" id="weakness-list">
                </ul>
        </div>
    </div>

    <div class="comments-section">
        <h3>Observaciones Cualitativas Generales</h3>
        <textarea placeholder="Escriba aqu√≠..."></textarea>
    </div>

    <div class="actions">
        <button onclick="window.print()">üñ®Ô∏è Generar Reporte PDF</button>
    </div>
</div>

<script>
    // DATA STRUCTURE
    const rubricData = [
        {
            title: "A. Competencias comunicacionales",
            criteria: [
                "Propone situaciones de lectura comprensiva aut√©ntica.",
                "Producci√≥n oral/escrita con prop√≥sito claro.",
                "Favorece la argumentaci√≥n, explicaci√≥n, an√°lisis."
            ]
        },
        {
            title: "B. Competencias cient√≠ficas y tecnol√≥gicas",
            criteria: [
                "Aborda problemas o procesos de investigaci√≥n.",
                "Promueve razonamiento, exploraci√≥n, resoluci√≥n.",
                "Usa herramientas tecnol√≥gicas significativamente."
            ]
        },
        {
            title: "C. Competencias socioemocionales",
            criteria: [
                "Incluye colaboraci√≥n, escucha, autorregulaci√≥n.",
                "Estrategias para sostener participaci√≥n/motivaci√≥n.",
                "Anticipa obst√°culos emocionales posibles."
            ]
        },
        {
            title: "D. Competencias ciudadanas y √©ticas",
            criteria: [
                "Problematiza situaciones reales o dilemas.",
                "Promueve pensamiento cr√≠tico y resp. social.",
                "Visibiliza derechos, normas y diversidad."
            ]
        },
        {
            title: "E. Competencias digitales cr√≠ticas",
            criteria: [
                "Uso con criterio: verificaci√≥n, cuidado.",
                "Reflexi√≥n sobre riesgos, sesgos y privacidad.",
                "An√°lisis cr√≠tico de informaci√≥n multimodal."
            ]
        },
        {
            title: "F. Competencias en Inteligencia Artificial",
            criteria: [
                "IA como herramienta formativa, no atajo.",
                "Ense√±a comprensi√≥n b√°sica y uso √©tico.",
                "Producci√≥n con IA: creatividad + criterio."
            ]
        }
    ];

    // STATE MANAGEMENT
    let selections = {}; // Stores { "row_0_1": 2, "row_0_2": 3 }
    const totalItems = rubricData.reduce((acc, cat) => acc + cat.criteria.length, 0);
    const maxScore = totalItems * 3;

    // RENDER TABLE
    const container = document.getElementById('rubric-table');
    let html = '<table><thead><tr><th>Criterios</th><th class="th-scale">1<br>D√©bil</th><th class="th-scale">2<br>En desarrollo</th><th class="th-scale">3<br>Consolidado</th></tr></thead><tbody>';

    rubricData.forEach((cat, catIndex) => {
        html += `<tr class="category-header"><td colspan="4">${cat.title}</td></tr>`;
        cat.criteria.forEach((crit, critIndex) => {
            const rowId = `r_${catIndex}_${critIndex}`;
            html += `
            <tr>
                <td>${crit}</td>
                <td class="score-cell" id="${rowId}_1" onclick="handleVote('${catIndex}', '${critIndex}', 1)">‚ö†Ô∏è</td>
                <td class="score-cell" id="${rowId}_2" onclick="handleVote('${catIndex}', '${critIndex}', 2)">üîÑ</td>
                <td class="score-cell" id="${rowId}_3" onclick="handleVote('${catIndex}', '${critIndex}', 3)">‚úÖ</td>
            </tr>`;
        });
    });
    html += '</tbody></table>';
    container.innerHTML = html;

    // LOGIC
    function handleVote(catIndex, critIndex, score) {
        const rowId = `r_${catIndex}_${critIndex}`;
        
        // Update State
        selections[rowId] = {
            score: score,
            catTitle: rubricData[catIndex].title,
            critText: rubricData[catIndex].criteria[critIndex]
        };

        // Update Visuals (Table)
        // Reset row
        document.getElementById(`${rowId}_1`).className = "score-cell";
        document.getElementById(`${rowId}_2`).className = "score-cell";
        document.getElementById(`${rowId}_3`).className = "score-cell";
        // Highlight selection
        document.getElementById(`${rowId}_${score}`).classList.add(`selected-${score}`);

        // Update Dashboard
        calculateResults();
    }

    function calculateResults() {
        let currentScore = 0;
        let weakListHTML = "";
        let countSelected = 0;

        // Process selections
        for (const [key, data] of Object.entries(selections)) {
            currentScore += data.score;
            countSelected++;

            // Weakness Logic (Score 1 or 2)
            if (data.score < 3) {
                const badge = data.score === 1 
                    ? `<span class="badge-1">D√âBIL</span>` 
                    : `<span class="badge-2">EN DESARROLLO</span>`;
                
                weakListHTML += `
                    <li>
                        <span class="tag-cat">${data.catTitle}</span>
                        ${badge} <span class="tag-crit">${data.critText}</span>
                    </li>`;
            }
        }

        // Update Score UI
        const percentage = Math.round((currentScore / maxScore) * 100);
        document.getElementById('total-score').innerText = `${currentScore} / ${maxScore}`;
        document.getElementById('percentage-display').innerText = `${percentage}% de logro`;

        // Update Weakness List UI
        const listContainer = document.getElementById('weakness-list');
        const emptyState = document.getElementById('empty-state');
        
        if (weakListHTML === "") {
            listContainer.innerHTML = "";
            if(countSelected > 0 && currentScore === countSelected * 3) {
                emptyState.innerText = "¬°Excelente! No se han detectado debilidades en los puntos evaluados.";
                emptyState.style.display = "block";
                emptyState.style.color = "#2e7d32";
            } else {
                emptyState.style.display = "block";
                emptyState.innerText = "Seleccione los criterios en la tabla para ver el an√°lisis.";
                emptyState.style.color = "#777";
            }
        } else {
            emptyState.style.display = "none";
            listContainer.innerHTML = weakListHTML;
        }
    }
</script>

</body>
</html>
   
